<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ángel Álamo, Juanjo Doblas, Óscar Vanrell">

<title>Entrega 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Doc_entrega1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Doc_entrega1_files/libs/quarto-html/quarto.js"></script>
<script src="Doc_entrega1_files/libs/quarto-html/popper.min.js"></script>
<script src="Doc_entrega1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Doc_entrega1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Doc_entrega1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Doc_entrega1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Doc_entrega1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Doc_entrega1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Doc_entrega1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Entrega 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ángel Álamo, Juanjo Doblas, Óscar Vanrell </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="análisis-exploratorio-de-datos-de-pingüinos" class="level1">
<h1>Análisis exploratorio de datos de pingüinos</h1>
<p>En esta práctica vamos a realizar un análisis exploratorio de los datos de pingüinos proporcionados por la Dra Kristen Gorman en la Estación Palmer, Antártida.</p>
<p>Lo primero de todo es cargar la librería “palmerpenguins”, así como el conjunto de datos “penguins”.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
<p>Algunas unidades muestrales presentan los valores “NA” en ciertas variables, por lo tanto, nosotros consideraremos solo aquellos que presentan unos valores conocidos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           36.7          19.3               193        3450
 5 Adelie  Torgersen           39.3          20.6               190        3650
 6 Adelie  Torgersen           38.9          17.8               181        3625
 7 Adelie  Torgersen           39.2          19.6               195        4675
 8 Adelie  Torgersen           41.1          17.6               182        3200
 9 Adelie  Torgersen           38.6          21.2               191        3800
10 Adelie  Torgersen           34.6          21.1               198        4400
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
<p>La muestra total se ha reducido a 333 unidades muestrales.</p>
<p>Podemos ver en la tabla de datos que hay 8 variables de interés. Estas variables son:</p>
<ul>
<li>Especie: Variable cualitativa que hace referencia a la especie del individuo. Toma los valores “Adelie”, “Chinstrap” y “Gentoo”. Observamos cuántas unidades hay por cada especie:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
   Adelie Chinstrap    Gentoo 
      146        68       119 </code></pre>
</div>
</div>
<ul>
<li>Isla: Variable cualitativa que hace referencia a la isla de donde procede el individuo. Toma los valores “Biscoe”, “Dream” y “Torgersen”. Veamos el número de pingüinos que viven en cada isla:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
   Biscoe     Dream Torgersen 
      163       123        47 </code></pre>
</div>
</div>
<ul>
<li>Largo del pico (mm): Variable cuantitativa continua que mide el largo del pico en mm del individuo. Tenemos estos datos generales sobre la variable:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                                                                        
"Min.   :32.10  " "1st Qu.:39.50  " "Median :44.50  " "Mean   :43.99  " 
                                    
"3rd Qu.:48.60  " "Max.   :59.60  " </code></pre>
</div>
</div>
<ul>
<li>Profundidad del pico (mm): Variable cuantitativa continua que mide la profundidad del pico en mm del individuo. Unos datos generales que podemos obtener son:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                                                                        
"Min.   :13.10  " "1st Qu.:15.60  " "Median :17.30  " "Mean   :17.16  " 
                                    
"3rd Qu.:18.70  " "Max.   :21.50  " </code></pre>
</div>
</div>
<ul>
<li>Longitud de la aleta (mm): Variable cuantitativa continua que mide la longitud de la aleta en mm del individuo.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                
"Min.   :172  " "1st Qu.:190  " "Median :197  " "Mean   :201  " "3rd Qu.:213  " 
                
"Max.   :231  " </code></pre>
</div>
</div>
<ul>
<li>Masa corporal (g): Variable cuantitativa continua que mide la masa corporal en gramos del individuo.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                                                                    
"Min.   :2700  " "1st Qu.:3550  " "Median :4050  " "Mean   :4207  " 
                                  
"3rd Qu.:4775  " "Max.   :6300  " </code></pre>
</div>
</div>
<ul>
<li>Sexo: Variable cualitativa que hace referencia al sexo del individuo. Mostramos cúantas unidades hay de cada sexo.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
female   male 
   165    168 </code></pre>
</div>
</div>
<ul>
<li>Año: Variable cualitativa ordinal que hace referencia al año en que se estudió al individuo. Aún siendo una variable númerica, la trataremos como un factor. Mostramos cuántas unidades han sido estudiadas en cada año.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
2007 2008 2009 
 103  113  117 </code></pre>
</div>
</div>
<p>Un análisis interesante puede ser estudiar las variables cuantitativas continuas en función de la especie, isla y el sexo.</p>
<p>Empecemos viendo qué especies habitan en cada isla a partir de un diagrama circular, donde el área de cada sector es proporcional a la frecuencia del nivel correspondiente.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Como podemos observar, los Adelie se encuentran en las 3 islas mientras que los Gentoo y los Chinstrap solo los podemos encontrar en una de ellas, siendo Biscoe la isla donde habita la especie Gentoo y Dream la isla donde habita la especie Chinstrap. A causa de estas diferencias, no se haran análisis respecto la variable isla en particular.</p>
<p>A continuación compararemos las caracteristicas de los Adelie en las diferentes islas para ver si la zona demográfica influye en la evolución de la especie a nivel fisiológico. Veamos primero cuántos pingüinos de la especie Adelie hay en cada isla:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   Biscoe     Dream Torgersen 
       44        55        47 </code></pre>
</div>
</div>
<p>Como podemos ver no hay gran diferencia de unidades, entonces tiene sentido ver los datos de la especie Adelie según la isla. Empezaremos con la longitud de sus aletas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>A rasgos generales, parece que la longitud de las aletas de la especie Adelie en las islas Dream y Biscoe presentan una distribución algo diferente que en la isla Torgersen, esto podemos intuirlo por las frecuencias que se muestran en los intervalos <span class="math inline">\((177, 183]\)</span> y <span class="math inline">\((188, 194]\)</span>. Otro aspecto a señalar podría ser la dispersión respecto a la media, tenemos que en la isla Dream la longitud de la aleta se acercan más al valor esperado: 190.103mm aunque podría deberse a la muestra obtenida y no refleja correctamente a la población completa.</p>
<p>Ahora estudiemos si hay diferencias significativas en las variables relacionadas con el pico:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/variables%20pico%20por%20islas-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Podemos ver que no hay diferencias significativas en las variables relacionadas con el pico entre los pingüinos Adelie de diferentes islas.</p>
<p>Por último, veamos si existe una variación aparentemente significativa en el peso corporal de la especie Adelie dependiendo de las islas. Esto podría ocurrir por distintos factores como: la dificultad que tienen los pingüinos para alimentarse debido a los depredadores; la distancia entre sus colonias y el lugar en el que cazan; o por posibles variaciones físicas.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Aparentemente no parece haber diferencias significativas, asi que vamos a dejar a los Adelie para empezar a estudiar las características fisicas de diferentes especies entre ellas y entre sexos.</p>
<p>Analicemos los rasgos diferentes de pingüinos segun especies. Aqui tenemos las longitudes de las aletas, las longitudes y profundidades de los picos y sus masas corporales:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Como podemos observar en los gráficos, los Gentoo son claramente los que tienen las aletas mas largas y los que tienen mayor masa corporal, en cambio son los que tienen la menor profundidad de pico. Por otra parte, las especies Adelie y Chinstrap tienen rasgos muy semejantes a excepción de la longitud de sus picos, en la cual los Adelie parecen tener el pico mas corto en comparación con las otras dos especies.</p>
<p>Analicemos los rasgos diferentes de pingüinos segun especies y sexo.</p>
<p>Primero de todo veamos cuantos machos y hembras hay en cada especie usando diagramas circulares, donde el área de cada sector es proporcional a la frecuencia del nivel correspondiente.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que hay, en cada especie, aproximadamente una proporción de 50% en los sexos.</p>
<p>Veamos las diferencias que hay por especie y sexo en cada una de las variables de las que disponemos:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>En este gráfico podemos observar que la especie Gentoo es la que tiene la longitud de las aletas más larga y parece que los machos tienen las aletas más largas que las hembras en las tres especies. También podemos observar una similitud en esta variable entre los Adelies machos y los Chinstrap hembras. Respecto los valores en cada grupo, los únicos que muestran valores atípicos son Adelie-Female y Adelie-Male.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>En este gráfico vemos claramente que la especie Adelie es la que tiene la menor longitud del pico. Podemos ver similitudes respecto a esta variable entre la especie Chinstrap y Gentoo, aunque los Chinstrap machos toman valores más compactos que los Gentoo machos. Como en el gráfico anterior, también vemos que los machos, en las tres especies, toman valores más altos que las hembras.</p>
<p>Por otro lado, se han presentado unos valores atípicos en los grupos Adelie-Male, Chinstrap-Female, Chinstrap-Male, y Gentoo-Male. Esto podría deberse a la falta de unidades muestrales en esos grupos para estudiar con detalle esta variable, haciendo que los valores estén más dispersos y no presente una distribución clara.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>En este caso, es la especie Gentoo la que toma los valores más pequeños y las especies Adelie y Chinstrap las que toman valores similares, aunque hay una diferencia notable entre la profundidad mínima de la especie Adelie y la Chinstrap. Volvemos a ver también que los machos toman valores más altos en las tres especies. Por último, los grupos que presentan valores atípicos son Adelie-Female, Adelie-Male</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Doc_entrega1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Respecto a la masa corporal, se vuelve a dar el caso que la especie Gentoo toma los valores más altos. También vemos ciertas similituddes entre las especies Adelie y Chinstrap. Vemos otra vez que los machos toman valores más altos que las hembras en las tres especies. En este caso, solo los grupos Chinstrap-Female y Chinstrap-Male muestran valores atípicos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Algun hist de frecuencias absolutas?</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hacemos un análisis general de las 4 variables?</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estudiar por años?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>